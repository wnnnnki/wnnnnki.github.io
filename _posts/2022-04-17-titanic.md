<div class="cell code" data-execution_count="1" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:14.540116Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:29:36.624356Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.502256Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:14.540865Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.500965Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.480344&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.541053&quot;,&quot;duration&quot;:6.0709e-2}" data-tags="[]">

``` python
# 데이터 확보
import numpy as np
import pandas as pd
train = pd.read_csv('../input/titanic/train.csv')
test = pd.read_csv('../input/titanic/test.csv')
```

</div>

<div class="cell code" data-execution_count="2" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:14.594917Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:29:38.748687Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.576228Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:14.594394Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.575581Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.557360&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.595093&quot;,&quot;duration&quot;:3.7733e-2}" data-tags="[]">

``` python
feature = pd.concat((train.iloc[:,2:], test.iloc[:,1:]))
Age_temp = feature['Age'].to_numpy()
Age_temp = Age_temp.reshape(-1, 1)
```

</div>

<div class="cell code" data-execution_count="3" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:14.648470Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:36:57.638691Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.629390Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:14.649176Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.628767Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.610629&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.649313&quot;,&quot;duration&quot;:3.8684e-2}" data-tags="[]">

``` python
train.info()
```

<div class="output stream stdout">

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 12 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   PassengerId  891 non-null    int64  
     1   Survived     891 non-null    int64  
     2   Pclass       891 non-null    int64  
     3   Name         891 non-null    object 
     4   Sex          891 non-null    object 
     5   Age          714 non-null    float64
     6   SibSp        891 non-null    int64  
     7   Parch        891 non-null    int64  
     8   Ticket       891 non-null    object 
     9   Fare         891 non-null    float64
     10  Cabin        204 non-null    object 
     11  Embarked     889 non-null    object 
    dtypes: float64(2), int64(5), object(5)
    memory usage: 83.7+ KB

</div>

</div>

<div class="cell code" data-execution_count="4" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:14.714725Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:38:31.837471Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.692478Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:14.715270Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.691782Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.665916&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.715414&quot;,&quot;duration&quot;:4.9498e-2}" data-tags="[]">

``` python
train.iloc[ :,2:] # 모든 행 확보 , 	PassengerId	Survived 제거
```

<div class="output execute_result" data-execution_count="4">

``` 
     Pclass                                               Name     Sex   Age  \
0         3                            Braund, Mr. Owen Harris    male  22.0   
1         1  Cumings, Mrs. John Bradley (Florence Briggs Th...  female  38.0   
2         3                             Heikkinen, Miss. Laina  female  26.0   
3         1       Futrelle, Mrs. Jacques Heath (Lily May Peel)  female  35.0   
4         3                           Allen, Mr. William Henry    male  35.0   
..      ...                                                ...     ...   ...   
886       2                              Montvila, Rev. Juozas    male  27.0   
887       1                       Graham, Miss. Margaret Edith  female  19.0   
888       3           Johnston, Miss. Catherine Helen "Carrie"  female   NaN   
889       1                              Behr, Mr. Karl Howell    male  26.0   
890       3                                Dooley, Mr. Patrick    male  32.0   

     SibSp  Parch            Ticket     Fare Cabin Embarked  
0        1      0         A/5 21171   7.2500   NaN        S  
1        1      0          PC 17599  71.2833   C85        C  
2        0      0  STON/O2. 3101282   7.9250   NaN        S  
3        1      0            113803  53.1000  C123        S  
4        0      0            373450   8.0500   NaN        S  
..     ...    ...               ...      ...   ...      ...  
886      0      0            211536  13.0000   NaN        S  
887      0      0            112053  30.0000   B42        S  
888      1      2        W./C. 6607  23.4500   NaN        S  
889      0      0            111369  30.0000  C148        C  
890      0      0            370376   7.7500   NaN        Q  

[891 rows x 10 columns]
```

</div>

</div>

<div class="cell code" data-execution_count="5" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:14.775592Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:51:09.440490Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.772143Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:14.776139Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.751383Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.732092&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.776298&quot;,&quot;duration&quot;:4.4206e-2}" data-tags="[]">

``` python
test.iloc[:,1:] # 	PassengerId 삭제 
```

<div class="output execute_result" data-execution_count="5">

``` 
     Pclass                                          Name     Sex   Age  \
0         3                              Kelly, Mr. James    male  34.5   
1         3              Wilkes, Mrs. James (Ellen Needs)  female  47.0   
2         2                     Myles, Mr. Thomas Francis    male  62.0   
3         3                              Wirz, Mr. Albert    male  27.0   
4         3  Hirvonen, Mrs. Alexander (Helga E Lindqvist)  female  22.0   
..      ...                                           ...     ...   ...   
413       3                            Spector, Mr. Woolf    male   NaN   
414       1                  Oliva y Ocana, Dona. Fermina  female  39.0   
415       3                  Saether, Mr. Simon Sivertsen    male  38.5   
416       3                           Ware, Mr. Frederick    male   NaN   
417       3                      Peter, Master. Michael J    male   NaN   

     SibSp  Parch              Ticket      Fare Cabin Embarked  
0        0      0              330911    7.8292   NaN        Q  
1        1      0              363272    7.0000   NaN        S  
2        0      0              240276    9.6875   NaN        Q  
3        0      0              315154    8.6625   NaN        S  
4        1      1             3101298   12.2875   NaN        S  
..     ...    ...                 ...       ...   ...      ...  
413      0      0           A.5. 3236    8.0500   NaN        S  
414      0      0            PC 17758  108.9000  C105        C  
415      0      0  SOTON/O.Q. 3101262    7.2500   NaN        S  
416      0      0              359309    8.0500   NaN        S  
417      1      1                2668   22.3583   NaN        C  

[418 rows x 10 columns]
```

</div>

</div>

<div class="cell code" data-execution_count="6" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:14.829200Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:29:40.907726Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.817827Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:14.829856Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.817168Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.794861&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.830001&quot;,&quot;duration&quot;:3.514e-2}" data-tags="[]">

``` python
feature.head()
```

<div class="output execute_result" data-execution_count="6">

``` 
   Pclass                                               Name     Sex   Age  \
0       3                            Braund, Mr. Owen Harris    male  22.0   
1       1  Cumings, Mrs. John Bradley (Florence Briggs Th...  female  38.0   
2       3                             Heikkinen, Miss. Laina  female  26.0   
3       1       Futrelle, Mrs. Jacques Heath (Lily May Peel)  female  35.0   
4       3                           Allen, Mr. William Henry    male  35.0   

   SibSp  Parch            Ticket     Fare Cabin Embarked  
0      1      0         A/5 21171   7.2500   NaN        S  
1      1      0          PC 17599  71.2833   C85        C  
2      0      0  STON/O2. 3101282   7.9250   NaN        S  
3      1      0            113803  53.1000  C123        S  
4      0      0            373450   8.0500   NaN        S  
```

</div>

</div>

<div class="cell markdown" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.848034&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:14.865837&quot;,&quot;duration&quot;:1.7803e-2}" data-tags="[]">

## 이름 제거

이름과 생존율의 연관은 상식적으로 없다고 생각

</div>

<div class="cell code" data-execution_count="7" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:15.919865Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:53:07.795865Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:14.908005Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:15.920366Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:14.907332Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:14.883633&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:15.920506&quot;,&quot;duration&quot;:1.036873}" data-tags="[]">

``` python
from sklearn.preprocessing import StandardScaler
Sclaer = StandardScaler()
Sclaer.fit(Age_temp)
Age_temp = Sclaer.transform(Age_temp)
feature['Age'] = Age_temp
feature = feature.fillna(0)
feature.pop('Name')
feature = pd.get_dummies(feature, dummy_na=True)
```

</div>

<div class="cell code" data-execution_count="8" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:16.027093Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:53:22.581806Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:15.959526Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:16.026158Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:15.958904Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:15.938438&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:16.027326&quot;,&quot;duration&quot;:8.8888e-2}" data-tags="[]">

``` python
feature.info()
```

<div class="output stream stdout">

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 1309 entries, 0 to 417
    Columns: 1131 entries, Pclass to Embarked_nan
    dtypes: float64(2), int64(3), uint8(1126)
    memory usage: 1.5 MB

</div>

</div>

<div class="cell code" data-execution_count="9" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:16.088045Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:53:33.680927Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:16.070957Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:16.088687Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:16.070331Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:16.046175&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:16.088841&quot;,&quot;duration&quot;:4.2666e-2}" data-tags="[]">

``` python
feature.head()
```

<div class="output execute_result" data-execution_count="9">

``` 
   Pclass       Age  SibSp  Parch     Fare  Sex_female  Sex_male  Sex_nan  \
0       3 -0.547050      1      0   7.2500           0         1        0   
1       1  0.563552      1      0  71.2833           1         0        0   
2       3 -0.269400      0      0   7.9250           1         0        0   
3       1  0.355314      1      0  53.1000           1         0        0   
4       3  0.355314      0      0   8.0500           0         1        0   

   Ticket_110152  Ticket_110413  ...  Cabin_F38  Cabin_F4  Cabin_G6  Cabin_T  \
0              0              0  ...          0         0         0        0   
1              0              0  ...          0         0         0        0   
2              0              0  ...          0         0         0        0   
3              0              0  ...          0         0         0        0   
4              0              0  ...          0         0         0        0   

   Cabin_nan  Embarked_0  Embarked_C  Embarked_Q  Embarked_S  Embarked_nan  
0          0           0           0           0           1             0  
1          0           0           1           0           0             0  
2          0           0           0           0           1             0  
3          0           0           0           0           1             0  
4          0           0           0           0           1             0  

[5 rows x 1131 columns]
```

</div>

</div>

<div class="cell markdown" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:16.108343&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:16.127334&quot;,&quot;duration&quot;:1.8991e-2}" data-tags="[]">

# 전처리 데이터 구분

</div>

<div class="cell code" data-execution_count="10" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:16.173698Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:56:05.550941Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:16.171901Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:16.174292Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:16.171217Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:16.146802&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:16.174432&quot;,&quot;duration&quot;:2.763e-2}" data-tags="[]">

``` python
X_train = feature.iloc[:891,:]
X_test = feature.iloc[891:,:]
y_train = train.iloc[:,1]
```

</div>

<div class="cell markdown" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:16.193428&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:16.212290&quot;,&quot;duration&quot;:1.8862e-2}" data-tags="[]">

# 훈련

</div>

<div class="cell code" data-execution_count="11" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:17.118082Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:56:45.869364Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:16.254008Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:17.118766Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:16.253026Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:16.231443&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:17.118914&quot;,&quot;duration&quot;:0.887471}" data-tags="[]">

``` python
from sklearn.ensemble import RandomForestClassifier
Random_modle = RandomForestClassifier()
Random_modle.fit(X_train,y_train)
pred_train=Random_modle.predict(X_train)
Random_modle.score(X_train, y_train)
```

<div class="output execute_result" data-execution_count="11">

    0.9988776655443322

</div>

</div>

<div class="cell markdown" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:17.139128&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:17.159019&quot;,&quot;duration&quot;:1.9891e-2}" data-tags="[]">

# csv 제출

</div>

<div class="cell code" data-execution_count="12" data-execution="{&quot;shell.execute_reply&quot;:&quot;2022-04-09T05:00:17.252167Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-09T04:57:23.725018Z&quot;,&quot;iopub.execute_input&quot;:&quot;2022-04-09T05:00:17.206641Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-09T05:00:17.251613Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-09T05:00:17.205668Z&quot;}" data-papermill="{&quot;status&quot;:&quot;completed&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2022-04-09T05:00:17.178442&quot;,&quot;end_time&quot;:&quot;2022-04-09T05:00:17.252356&quot;,&quot;duration&quot;:7.3914e-2}" data-tags="[]">

``` python
summit = pd.DataFrame()
summit['PassengerId'] = test['PassengerId']
summit['Survived'] = Random_modle.predict(X_test)
summit.to_csv('titanic_predict.csv', index=False)
```

</div>
